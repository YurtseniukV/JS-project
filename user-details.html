<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<h1><a href="index.html">Users list</a></h1>
<script>
    console.log(location)
    let userId = new URL(location.href).searchParams.get('id');
    console.log(userId)
    let baseURL = `https://jsonplaceholder.typicode.com/users/${userId}`
    let postsURL = `https://jsonplaceholder.typicode.com/posts?userId=${userId}`


    fetch(baseURL)
        .then(resp => resp.json())
        .then(user => {
            console.log(user)
            let userContainer = document.createElement('div');
            userContainer.classList.add('userContainer');
            document.body.appendChild(userContainer);


            for (const key in user) {

                if (typeof user[key] === 'object') {
                    let ul = document.createElement('ul')
                    ul.innerText = `${key} : `

                    Object.entries(user[key]).forEach(([item, value]) => {
                        let li = document.createElement('li')
                        if (item === 'geo') {
                            li.innerText = `${item} ( "${value.lat}" , "${value.lng}" )`

                        } else {
                            li.innerText = `${item} : ${value}.`
                        }


                        ul.appendChild(li);
                    });

                    userContainer.appendChild(ul)
                } else {
                    let p = document.createElement('p');
                    userContainer.appendChild(p)
                    p.innerHTML = `${key} - ${user[key]}`;
                }


            }


            let buttonCurrentPost = document.createElement('button');
            buttonCurrentPost.classList.add('buttonCurrentPost');
            buttonCurrentPost.innerText = 'post of current user';
            userContainer.appendChild(buttonCurrentPost);


            let getUserPost = function () {
                fetch(postsURL)
                    .then(resp => resp.json())
                    .then(posts => {

                        for (const post of posts) {
                            console.log(post.title)

                            let postTitle = document.createElement('h3')
                            postTitle.innerText = post.title;

                            let buttonAboutPost = document.createElement('button');
                            buttonAboutPost.innerText = 'Read more...'

                            buttonAboutPost.addEventListener('click', () => {
                                location.href = `post.details.html?id=${user.id}`;
                            })

                            userContainer.append(postTitle,buttonAboutPost);
                        }

                    })
            }


            buttonCurrentPost.addEventListener('click', () => {
                getUserPost()
            })

        })


</script>

</body>
</html>